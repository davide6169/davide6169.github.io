<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.5.2" />
<meta name="description" content="an open source UNIX framework for shell script based web service provider" />
<meta name="keywords" content="mysvc, shell script, web service, provider, service, soa, template, engine, myste, mysde, mysvcd" />
<link rel="stylesheet" href="../xhtml11.css" type="text/css" />
<link rel="stylesheet" href="../xhtml11-quirks.css" type="text/css" />
<link rel="stylesheet" href="../layout1.css" type="text/css" />
<title>MySVC</title>
</head>
<body>
<div id="layout-banner">
  <div id="layout-title">MySVC</div>
  <div id="layout-description">an open source UNIX framework for shell script based web services provider</div>
</div>
<table>
<tr valign="top">
<td id="layout-menu">
  <div>&#187;<a href="../index.html">Home</a></div>
  <div>&#187;<a href="../tools.html">Tools</a></div>
  <div>&#187;<a href="../manpage.html">Man&nbsp;Page</a></div>
  <div>&#187;<a href="../userguide.html">User&nbsp;Guide</a></div>
  <div>&#187;<a href="../changelog.html">ChangeLog</a></div>
  <div>&#187;<a href="../install.html">Installation</a></div>
  <div>&#187;<a href="../sourcecode.html">Source Code</a></div>
  <div>&#187;<a href="../downloads.html">Downloads</a></div>
  <div>&#187;<a href="../faq.html">FAQ</a></div>
  <div>&#187;<a href="../support.html">Support</a></div>
  <div>&#187;<a href="../license.html">License</a></div>
  <hr/>
  <div>&#187;<a href="../myapps/index.html">My Apps</a></div>
  <div>
  <hr/>
  <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
  <input type="hidden" name="cmd" value="_s-xclick">
  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
  ">
  <input type="image" src="https://www.paypal.com/en_US/IT/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="">
  <img alt="" border="0" src="https://www.paypal.com/it_IT/i/scr/pixel.gif" width="1" height="1">
  </form>
  </div>
</td>
<td>
<div id="layout-content">
<div id="header">
<h1>MySVCD Source Code</h1>
</div>
<h2 id="_spe">spe</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><tt>#!/bin/sh
#\
exec expect "$0" -- ${1+"$@"}

# #######################################################################
#
#  ###   ##        ### ##  ##  ####
#   ##  ##        #  #  #  ## ##  #
#   ### ##  ##  # ###   #  #  #
#   # ## #   # ##   ##   # #  #
#   # #  #   # #  #  #   ##   ##
#  ###  ###   ##  ###     #    ####
#             #
#            #
#
#  My Service
#
# #######################################################################
#
#  Client Example used in BLU as generic TCP/IP protocol handler
#  for mysvcd server on expect external mode
#
# #######################################################################
#
#   Simple Tcp/Ip protocol Handler
#
#   Script: spe - Simple Protocol Evaluator
#
#   Version: 1.0
#
#   Date: 21/03/2002
#
#   Author: Davide Cucciniello
#           BLU IT/SSPM
#
#   Usage:
#     spe [-s &lt;server&gt;]
#         [-f &lt;configfile&gt;]
#         [-r]
#         [-q]
#         [-i]
#         [-l]
#         [-d]
#         [&lt;protocolhandler&gt;]
#
#       &lt;server&gt; = &lt;addr&gt;[:&lt;port&gt;]
#
#         -r =&gt; request
#         -q =&gt; quite
#         -i =&gt; interactive
#         -l =&gt; local
#         -d =&gt; decode
#
#       default:
#         &lt;server&gt; = $SP_SERVER
#         &lt;configfile&gt; = "~/.sp_profile"
#
#   Input:
#     standard input
#
#   Output:
#     standard output
#
#   Description:
#     Service Platform Evaluator
#
# #######################################################################

proc usage {} {
  send_error "spe - Service Platform Evaluator - Ver 1.0\n"
  send_error "\n"
  send_error "usage: spe \[-s &lt;server&gt;]\n"
  send_error "           \[-f &lt;configfile&gt;]\n"
  send_error "           \[-r]\n"
  send_error "           \[-q]\n"
  send_error "           \[-i]\n"
  send_error "           \[-l]\n"
  send_error "           \[-d]\n"
  send_error "           \[&lt;protocolhandler&gt;]\n"
  send_error "\n"
  send_error "  &lt;server&gt; = &lt;addr&gt;\[:&lt;port&gt;]\n"
  send_error "\n"
  send_error "    -r =&gt; request\n"
  send_error "    -q =&gt; quite\n"
  send_error "    -i =&gt; interactive\n"
  send_error "    -l =&gt; local\n"
  send_error "    -d =&gt; decode\n"
  send_error "\n"
  send_error "  default:\n"
  send_error "    &lt;server&gt; = \$SP_SERVER\n"
  send_error "    &lt;configfile&gt; = ~/.sp_profile\n"

  exit 1
}

proc initParameters {} {
  global parameter
  global env

  set parameter(port) "28000"

  if [info exists env(SP_SERVER)] {
    # SP_SERVER ::= &lt;addr&gt;[:&lt;port&gt;]

    set parameter(server) "$env(SP_SERVER)"
  } else {
    set parameter(server) "0:$parameter(port)"
  }

  set parameter(interactive) 0
  set parameter(quite) 0
  set parameter(request) 0
  set parameter(decode) 0

  set parameter(prompt) "sp&gt; "
}

proc parseArguments {} {
  global argv parameter

  set state flag

  foreach arg $argv {
    switch -- $state {
      flag {
        switch -regexp -- $arg {
          {-h.*} {usage}
          {-f.*} {set state configfile}
          {-s.*} {set state server}
          {-r.*} {set parameter(request) 1}
          {-q.*} {set parameter(quite) 1}
          {-i.*} {set parameter(interactive) 1}
          {-d.*} {set parameter(decode) 1}
          {-l.*} {unset parameter(server)}
          {^[^-]} {
            set parameter(protocolhandler) "\"$arg\""
            set state protocolhandler
          }
        }
      }
      configfile {
        set parameter(configfile) $arg

        set state flag
      }
      server {
        set parameter(server) $arg

        set state flag
      }
      protocolhandler {
        append parameter(protocolhandler) " \"$arg\""
      }
    }
  }
}

proc checkParameters {} {
  global parameter

  if {[info exists parameter(configfile)] &amp;&amp;
     ![file exists $parameter(configfile)]} {
    usage
  }
}

proc init {} {
  global parameter

  initParameters
  parseArguments

  checkParameters

  # execute initialization file

  if [info exists parameter(configfile)] {
    set initfile "$parameter(configfile)"
  } else {
    set initfile "~/.sp_profile"
  }

  if [file exists $initfile] {
    uplevel #0 source $initfile
  }
}

proc urlDecode {url} {
  # decode inputs to a CGI program: name1=value1&amp;name2=value2 ...

  regsub -all {\+} $url { } url
  regsub -all {%([0-9a-fA-F][0-9a-fA-F])} $url \
    {[format %c 0x\1]} url

  return [subst $url]
}

proc decode {request} {
  global parameter

  if $parameter(decode) {
    return [urlDecode $request]
  } else {
    return $request
  }
}

proc recvfrom {sock addr port} {
  global parameter

  # receive response from server
  # write response to standard output

  if {[eof $sock]||[catch {gets $sock response}]} {
    if {![eof $sock]} {
      send_error "error: cannot receive response from server $addr:$port\n"
    } elseif $parameter(interactive) {
      send_error "\n"
    }

    exit 1
  } else {
    if [string compare "$response" ""] {
      puts "$response"

      if $parameter(interactive) {
        send_error "$parameter(prompt)"
      }
    }
  }
}

proc sendto {sock addr port} {
  global parameter

  # read request from standard input
  # send request to server

  if {[eof stdin]||[catch {gets stdin request}]} {
    catch {close $sock}

    exit 0
  } else {
    if [string compare "$request" "" ] {
      if [catch {puts $sock [decode "$request"]}] {
        send_error "error: cannot send request to server $addr:$port\n"

        exit 1
      }
    }
  }
}

proc readfrom {protocolhandler sock addr port} {
  global parameter

  # read request from protocol handler
  # send request to server

  if {[eof $protocolhandler] || ([gets $protocolhandler request] &lt; 0)} {
    if ![eof $protocolhandler] {
      send_error "error: cannot read from $parameter(protocolhandler)\n"

      catch {close $protocolhandler}
      catch {close $sock}

      exit 1
    }

    catch {close $protocolhandler}
    catch {close $sock}

    exit 0
  } else {
    if [string compare "$request" "" ] {
      if [catch {puts $sock [decode "$request"]}] {
        send_error "error: cannot write to server $addr:$port\n"

        exit 1
      }

      if {!$parameter(quite) &amp;&amp; $parameter(request)} {
        send_error "$request\n"
      }
    }
  }
}

proc writeto {protocolhandler sock addr port} {
  global parameter

  # receive response from server
  # write response to protocol handler

  if {[eof $sock]||[catch {gets $sock response}]} {
    if {![eof $sock]} {
      send_error "error: cannot read from server $addr:$port\n"

      exit 1
    }

    exit 0
  } else {
    if [string compare "$response" ""] {
      if [catch {puts $protocolhandler "$response"}] {
        send_error "error: cannot write to $protocolhandler\n"

        exit 1
      }

      if !$parameter(quite) {
        send_user "$response\n"
      }
    }
  }
}

proc run {} {
  global parameter

  # read commands from standard input and
  # write result on standard output

  if [info exists parameter(server)] {
    set serverinfo [split "$parameter(server)" ":"]

    if {[llength $serverinfo] == 1} {
      set addr [lindex $serverinfo 0]
      set port $parameter(port)
    } else {
      set addr [lindex $serverinfo 0]
      set port [lindex $serverinfo 1]
    }

    if [catch {socket $addr $port} sock] {
      send_error "error: cannot open connection to server $addr:$port\n"

      exit 1
    } else {
      fconfigure $sock -buffering line
      fconfigure $sock -blocking 1

      if [info exists parameter(protocolhandler)] {
        if [catch {open "|$parameter(protocolhandler)" r+} protocolhandler] {
          send_error "error: cannot execute protocol handler $parameter(protocolhandler)"

          exit 1
        }

        fileevent $sock readable [list writeto $protocolhandler $sock $addr $port]

        fconfigure $protocolhandler -buffering line

        fileevent $protocolhandler readable \
          [list readfrom $protocolhandler $sock $addr $port]
      } else {
        fileevent $sock readable [list recvfrom $sock $addr $port]

        fconfigure stdin -buffering line
        fconfigure stdin -blocking 1

        fileevent stdin readable [list sendto $sock $addr $port]

        if $parameter(interactive) {
          send_error "$parameter(prompt)"
        }
      }

      vwait forever
    }
  } else {
    set cmd {}

    while {![eof stdin]} {
      # read a command from standard input
      # execute it
      # send result to standard output

      if $parameter(interactive) {
        send_error "$parameter(prompt)"
      }

      append cmd [gets stdin]

      if [info complete $cmd] {
        catch {uplevel #0 $cmd} result
        puts $result
        set cmd {}
      }
    }
  }
}

proc main {} {
  init
  run
}

main

# end of script</tt></pre>
</div></div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.400<br />
Last updated 2014-06-28 16:24:08 CEST
</div>
<div id="footer-badges">
<img style="border:none; width:88px; height:31px;"
     src="../images/gplv3-127x51.png"
     alt="GPL Version 3" />
<!-- Histats.com  START  -->
<a href="http://www.histats.com" target="_blank" title="simple hit counter" >
<script  type="text/javascript" language="javascript">
var s_sid = 675659;var st_dominio = 4;
var cimg = 0;var cwi =112;var che =48;
</script></a><script  type="text/javascript" language="javascript" src="http://s10.histats.com/js9.js"></script>
<noscript><a href="http://www.histats.com" target="_blank">
<img  src="http://s4.histats.com/stats/0.gif?675659&1" alt="simple hit counter" border="0"></a>
</noscript>
<!-- Histats.com  END  -->
</div>
</div>
</div>
</td>
</tr>
</table>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-11334618-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
