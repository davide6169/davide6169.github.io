<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.5.2" />
<meta name="description" content="an open source UNIX framework for shell script based web service provider" />
<meta name="keywords" content="mysvc, shell script, web service, provider, service, soa, template, engine, myste, mysde, mysvcd" />
<link rel="stylesheet" href="../xhtml11.css" type="text/css" />
<link rel="stylesheet" href="../xhtml11-quirks.css" type="text/css" />
<link rel="stylesheet" href="../layout1.css" type="text/css" />
<title>MySVC</title>
</head>
<body>
<div id="layout-banner">
  <div id="layout-title">MySVC</div>
  <div id="layout-description">an open source UNIX framework for shell script based web services provider</div>
</div>
<table>
<tr valign="top">
<td id="layout-menu">
  <div>&#187;<a href="../index.html">Home</a></div>
  <div>&#187;<a href="../tools.html">Tools</a></div>
  <div>&#187;<a href="../manpage.html">Man&nbsp;Page</a></div>
  <div>&#187;<a href="../userguide.html">User&nbsp;Guide</a></div>
  <div>&#187;<a href="../changelog.html">ChangeLog</a></div>
  <div>&#187;<a href="../install.html">Installation</a></div>
  <div>&#187;<a href="../sourcecode.html">Source Code</a></div>
  <div>&#187;<a href="../downloads.html">Downloads</a></div>
  <div>&#187;<a href="../faq.html">FAQ</a></div>
  <div>&#187;<a href="../support.html">Support</a></div>
  <div>&#187;<a href="../license.html">License</a></div>
  <hr/>
  <div>&#187;<a href="../myapps/index.html">My Apps</a></div>
  <div>
  <hr/>
  <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
  <input type="hidden" name="cmd" value="_s-xclick">
  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
  ">
  <input type="image" src="https://www.paypal.com/en_US/IT/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="">
  <img alt="" border="0" src="https://www.paypal.com/it_IT/i/scr/pixel.gif" width="1" height="1">
  </form>
  </div>
</td>
<td>
<div id="layout-content">
<div id="header">
<h1>MySVCD Source Code</h1>
</div>
<h2 id="_stpexec">stpexec</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre><tt>#!/bin/ksh

# #######################################################################
#
#  ###   ##        ### ##  ##  ####
#   ##  ##        #  #  #  ## ##  #
#   ### ##  ##  # ###   #  #  #
#   # ## #   # ##   ##   # #  #
#   # #  #   # #  #  #   ##   ##
#  ###  ###   ##  ###     #    ####
#             #
#            #
#
#  My Service
#
# #######################################################################
#
#  Client Example used in BLU as driver for STP Network Elements for MNP
#
# #######################################################################
#
#  Script: stpexec - STP Socket Client
#
#  Version: 2.0
#
#  Author: Davide Cucciniello
#
#  Date: 28/08/2002
#
#  Usage:
#    stpexec [-f &lt;inputfile&gt;]
#            [-o &lt;outputfile&gt;]
#            [-S &lt;stpid&gt;]
#            [-n &lt;stpnumber&gt;]
#            [-i &lt;imsi&gt;]
#            [-s &lt;server&gt;]
#            [-1]
#            [-2]
#            [-N]
#            &lt;command&gt; [&lt;data&gt;]
#
#     -1 =&gt; first stp
#     -2 =&gt; second stp
#     -N =&gt; not data
#
#  Description:
#    Execute a command on STP using Socket Interface
#
# #######################################################################

function usage
{
  print -u2 "stpexec - STP Socket Client - 2.0"
  print -u2 ""
  print -u2 "usage: stpexec [-f &lt;inputfile&gt;]"
  print -u2 "               [-o &lt;outputfile&gt;]"
  print -u2 "               [-S &lt;stpid&gt;]"
  print -u2 "               [-n &lt;stpnumber&gt;]"
  print -u2 "               [-i &lt;imsi&gt;]"
  print -u2 "               [-s &lt;server&gt;]"
  print -u2 "               [-1] "
  print -u2 "               [-2] "
  print -u2 "               [-N] "
  print -u2 "               &lt;command&gt; [&lt;data&gt;]"
  print -u2 ""
  print -u2 "  -1 =&gt; first stp"
  print -u2 "  -2 =&gt; second stp"

  exit 1
}

function initParameters
{
  configfile="../cfg/stp.cfg"

  inputfile=""
  outputfile=""
  command=""
  data=""
  stpid=""
  imsi=""
  server=""
  stpcommand=""
  stpbase="RM"
  stpnumber="1"
  notdata=0
}

function parseArguments
{
  while getopts :f:o:s:c:D:y:i:p:n:SN12h option
  do
    case $option in
      "h")
        usage
        ;;
      "f")
        inputfile="$OPTARG"
        ;;
      "o")
        outputfile="$OPTARG"
        ;;
      "s")
        server="$OPTARG"
        ;;
      "c")
        command="$OPTARG"
        if [ "$command" = "logout" ]; then
          notdata=1
        fi
        ;;
      "D")
        data="$OPTARG"
        ;;
      "i")
        imsi="$OPTARG"
        ;;
      "S")
        stpid="$OPTARG"
        ;;
      "n")
        stpnumber="$OPTARG"
        ;;
      "q")
        query=1
        ;;
      "1")
        stpbase="RM"
        ;;
      "2")
        stpbase="MI"
        ;;
      "N")
        notdata=1
        ;;
      \?)
        usage
        ;;
    esac
  done

  (( optionNum = OPTIND - 1 ))
  shift $optionNum

  if [ $# -gt 0 -a "$command" = "" ]; then
    command="$1"
    shift

    if [ $# -gt 0 -a "$data" = "" ]; then
      data="$1"
    fi
  elif [ $# -gt 0 -a "$data" = "" ]; then
    data="$1"
  fi
}

function getParameter
{
  value=$(./cfh $configfile "$1")

  if [ $? = 0 ]; then
    # parameter found

    print "$value"

    return 0
  else
    # parameter not found

    return 1
  fi
}

function getSTPCommand
{
  if [ "$data" = "" ]; then
    if [ $notdata = 1 ]; then
      stpcommand=$(getParameter "$command")
    fi
  else
    stpcommand=$(getParameter "$command($data)")
  fi
}

function putSTPCommand
{
  while :
  do
    if [ $# = 0 ]; then
      stpresult=$(./spe -s "$server" ./stpe $stpcommand 2&gt;/dev/null)
    else
      stpresult=$(./spe -s "$server" ./stpe $1 2&gt;/dev/null)
    fi

    if [ $? != 0 ]; then
      errorcode="-1"

      return 1
    fi

    if [ "$stpresult" != "" ]; then
      errorcode=$(echo "$stpresult" | awk '{ print $1 }')

      return 0
    fi

    sleep 1
  done
}

function putSTPResult
{
  if [ "$stpresult" != "" ]; then
    print -R "$stpresult"
  fi
}

function getSTPList
{
  n=$(getParameter "STP_NUMBER")

  stplist=""

  ((i = 1))

  while ((i &lt;= n))
  do
    stpid=$(getParameter "STP_ID_${i}")

    if [ "$stplist" = "" ]; then
      stplist="$stpid"
    else
      stplist="$stplist $stpid"
    fi

    ((i = i + 1))
  done
}

function getSTPId
{
  if [ "${imsi}" != "" ]; then
    stpnumber=$(getParameter "STP_IMSI2NUMBER($imsi)")
  fi

  stpid="${stpbase}${stpnumber}"
}

function getSTPAccount
{
  userid=$(getParameter "STP_${stpid}_SERVER_USER")

  username=$(echo "$userid" | awk -F'/' '{ print $1 }')
  password=$(echo "$userid" | awk -F'/' '{ print $2 }')
}

function getSTPLogin
{
  getSTPAccount

  stplogin="login $username $password"
}

function getServer
{
  server=$(getParameter "STP_${stpid}_SERVER")
}

function runApplication
{
  if [ "$server" = "" ]; then
    if [ "$stpid" = "" ]; then
      getSTPId
    fi

    if [ "$stpid" != "" ]; then
      getServer
    fi
  fi

  if [ "$command" != "" ]; then
    getSTPCommand
  fi

  if [ "$stpcommand" != "" ]; then
    if [ "$server" != "" ]; then
      putSTPCommand

      if [ $? = 0 ]; then
        if [ "$errorcode" = "2" ]; then
          getSTPLogin

          putSTPCommand "$stplogin"
          putSTPCommand

          if [ $? = 0 ]; then
            putSTPResult

            exit 0
          else
            exit 1
          fi
        fi

        putSTPResult

        exit 0
      else
        exit 1
      fi
    else
      getSTPList

      for stpid in $stplist
      do
        getServer

        putSTPCommand

        if [ $? = 0 ]; then
          if [ "$errorcode" = "2" ]; then
            getSTPLogin
            putSTPCommand "$stplogin"

            if [ "$errorcode" != "0" ]; then
              putSTPResult

              exit 1
            fi

            putSTPCommand

            if [ "$errorcode" = "0" ]; then
              putSTPResult

              exit 0
            fi
          elif [ "$errorcode" = "0" ]; then
            putSTPResult

            exit 0
          fi
        fi
      done

      putSTPResult

      exit 1
    fi
  else
    if [ "$inputfile" != "" ]; then
      exec &lt; $inputfile
    fi

    if [ "$outputfile" != "" ]; then
      exec &gt; $outputfile
    fi

    if [ "$server" != "" ]; then
      if [ "$command" != "" ]; then
        while read data
        do
          getSTPCommand
          putSTPCommand

          if [ "$errorcode" = "2" ]; then
            getSTPLogin
            putSTPCommand "$stplogin"
            putSTPCommand
          fi

          putSTPResult
        done
      else
        while read stpcommand
        do
          putSTPCommand

          if [ "$errorcode" = "2" ]; then
            getSTPLogin
            putSTPCommand "$stplogin"
            putSTPCommand
          fi

          putSTPResult
        done
      fi
    else
      getSTPList

      while read data
      do
        getSTPCommand

        if [ "$imsi" != "" -o "$stpnumber" != "0" ]; then
          getSTPId

          if [ "$stpid" != "" ]; then
            getServer

            putSTPCommand

            if [ "$errorcode" = "2" ]; then
              getSTPLogin
              putSTPCommand "$stplogin"
              putSTPCommand
            fi

            putSTPResult
          fi
        else
          for stpid in $stplist
          do
            getServer

            putSTPCommand

            if [ "$errorcode" = "2" ]; then
              getSTPLogin
              putSTPCommand "$stplogin"
              putSTPCommand
            fi

            if [ "$errorcode" = "0" ]; then
              break
            fi
          done

          putSTPResult
        fi
      done
    fi
  fi

  exit 0
}

# ##################################################################

# main

initParameters $*
parseArguments $*
runApplication $*

# End of script</tt></pre>
</div></div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.400<br />
Last updated 2014-06-28 16:24:10 CEST
</div>
<div id="footer-badges">
<img style="border:none; width:88px; height:31px;"
     src="../images/gplv3-127x51.png"
     alt="GPL Version 3" />
<!-- Histats.com  START  -->
<a href="http://www.histats.com" target="_blank" title="simple hit counter" >
<script  type="text/javascript" language="javascript">
var s_sid = 675659;var st_dominio = 4;
var cimg = 0;var cwi =112;var che =48;
</script></a><script  type="text/javascript" language="javascript" src="http://s10.histats.com/js9.js"></script>
<noscript><a href="http://www.histats.com" target="_blank">
<img  src="http://s4.histats.com/stats/0.gif?675659&1" alt="simple hit counter" border="0"></a>
</noscript>
<!-- Histats.com  END  -->
</div>
</div>
</div>
</td>
</tr>
</table>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-11334618-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
